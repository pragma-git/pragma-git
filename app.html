<html>
<head>
    <title>Pragma-git</title>
    
    <link rel="stylesheet" type="text/css" href="color_styles.css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link rel="stylesheet" type="text/css" href="slider_switch.css" />
    
    <script src="app.js"></script>
    

    <!-- Border for dropping folder-->
    <style>
        #content { border: 3px solid #dddddd; }
        #content.hover  { border: 3px dashed #333; }
    </style>


</head>


<body id='body' class='light'>

    <!-- Dark mode on/off --> 
    <script>
        if (localState.dark){
            document.body.classList.remove('light');
            document.body.classList.add('dark');
        }
    </script>
    
    <!-- Top titlebar -->    
    
    <div id="top-titlebar" class="top-titlebar" style="background-color: rgb(122, 124, 124);">
                
        <!-- Icon About  --> 
        <div class="about-icon"> 
            <img id="about-icon"    height="17" width="17"  
                onclick="updateImageUrl('about-icon', 'images/questionmark.png');
                        _callback('clicked-about');" 
                onmouseover="updateImageUrl('about-icon', 'images/questionmark_hover.png');" 
                onmouseout= "updateImageUrl('about-icon', 'images/questionmark.png');" 
                src="images/questionmark.png">

        </div>
            

        <div id="top-titlebar-text" class="top-titlebar-text">
            
            <!-- Text Repo  --> 
            &nbsp;<div id="top-titlebar-repo-arrow" class="top-titlebar-branch-arrow" 
                onclick="document.getElementById('top-titlebar-repo-arrow').setAttribute('style','color: #ffffff');
                        _callback('clicked-repo', 'menu')" 
                onmouseover="document.getElementById('top-titlebar-repo-arrow').setAttribute('style','color: #aaaaaa');" 
                onmouseout="document.getElementById('top-titlebar-repo-arrow').setAttribute('style','color: #ffffff');" 
                >&#x25BE;</div>
                
            <div id="top-titlebar-repo-text" class="top-titlebar-repo-text" 
                onclick="document.getElementById('top-titlebar-repo-text').setAttribute('style','color: #ffffff');_callback('clicked-repo', 'cycle')" 
                onmouseover="document.getElementById('top-titlebar-repo-text').setAttribute('style','color: #aaaaaa');" 
                onmouseout="document.getElementById('top-titlebar-repo-text').setAttribute('style','color: #ffffff');" >
            </div>
            
            <!-- Text Branch  --> 
            &nbsp;(<div id="top-titlebar-branch-arrow" class="top-titlebar-branch-arrow" 
                onclick="document.getElementById('top-titlebar-branch-arrow').setAttribute('style','color: #ffffff');
                         _callback('clicked-branch', 'menu')" 
                onmouseover="document.getElementById('top-titlebar-branch-arrow').setAttribute('style','color: #aaaaaa');" 
                onmouseout="document.getElementById('top-titlebar-branch-arrow').setAttribute('style','color: #ffffff');" 
                >&#x25BE;</div>
                
                <div id="top-titlebar-branch-text" class="top-titlebar-branch-text" 
                onclick="document.getElementById('top-titlebar-branch-text').setAttribute('style','color: #ffffff');
                         _callback('clicked-branch', 'cycle')" 
                onmouseover="document.getElementById('top-titlebar-branch-text').setAttribute('style','color: #aaaaaa');" 
                onmouseout="document.getElementById('top-titlebar-branch-text').setAttribute('style','color: #ffffff');" >
            </div>)
            &nbsp;
             
            <!-- Icon Notes  -->                             
            <div class="top-titlebar-notes-icon">
                <img id="top-titlebar-notes-icon" height="17" width="17" 
                    onclick="updateImageUrl('top-titlebar-notes-icon', 'images/notes.png');
                             _callback('clicked-notes')"
                    onmouseover="updateImageUrl('top-titlebar-notes-icon', 'images/notes_hover.png');" 
                    onmouseout= "updateImageUrl('top-titlebar-notes-icon', 'images/notes.png');" 
                    src="images/notes.png">
            </div> 
 
        </div>     
        
        
                    



        <!-- NOTE : set absolute positions in style.css -->
 

 
        <!-- Icon Branch  -->                             
        <div class="top-titlebar-branch-icon">
            <img id="top-titlebar-branch-icon" height="17" width="17" 
                onclick="updateImageUrl('top-titlebar-branch-icon', 'images/branch.png');
                         document.getElementById('branchNameInputDialog').showModal();" 
                onmouseover="updateImageUrl('top-titlebar-branch-icon', 'images/branch_hover.png');" 
                onmouseout= "updateImageUrl('top-titlebar-branch-icon', 'images/branch.png');" 
                src="images/branch.png">
        </div> 
                
                                                 
        <!-- Icon Merge  -->                             
        <div class="top-titlebar-merge-icon">
            <img id="top-titlebar-merge-icon" height="17" width="17" 
                onclick="updateImageUrl('top-titlebar-merge-icon', 'images/merge.png');
                         _callback('clicked-merge-button')" 
                onmouseover="updateImageUrl('top-titlebar-merge-icon', 'images/merge_hover.png');" 
                onmouseout= "updateImageUrl('top-titlebar-merge-icon', 'images/merge.png');" 
                src="images/merge.png">
        </div> 
                
                        
        <!-- Icon Pull  --> 
        <div class="top-titlebar-pull-icon">
            <img id="top-titlebar-pull-icon" height="17" width="17" 
                onclick="_callback('clicked-pull-button')" 
                onmouseover="updateImageUrl('top-titlebar-pull-icon', 'images/pull_hover.png');" 
                onmouseout= "updateImageUrl('top-titlebar-pull-icon', 'images/pull.png');" 
                src="images/pull.png">
        </div>   

                   
        <!-- Icon Push  -->         
        <div class="top-titlebar-push-icon">
            <img id="top-titlebar-push-icon" height="17" width="17" 
                onclick="updateImageUrl('top-titlebar-push-icon', 'images/push.png');
                         _callback('clicked-push-button')" 
                onmouseover="updateImageUrl('top-titlebar-push-icon', 'images/push_hover.png');" 
                onmouseout= "updateImageUrl('top-titlebar-push-icon', 'images/push.png');" 
                src="images/push.png">
        </div> 
    
                        
        <!-- Icon Tag  -->                             
        <div class="top-titlebar-tag-icon">
            <img id="top-titlebar-tag-icon" height="17" width="auto" 
                onclick="updateImageUrl('top-titlebar-tag-icon', 'images/tag.png');
                         _callback('clicked-tag-button');" 
                onmouseover="updateImageUrl('top-titlebar-tag-icon', 'images/tag_hover.png');" 
                onmouseout= "updateImageUrl('top-titlebar-tag-icon', 'images/tag.png');" 
                src="images/tag.png">
        </div> 
                        
        
        <!-- Top right icons  -->           
        <div class="top-titlebar-close-field">  
                    
            <!-- Icon Minimize  -->                     
            <img id="top-titlebar-minimize-icon" height="17" width="17" 
                onclick="_callback('clicked-minimize-button')" 
                onmouseover="updateImageUrl('top-titlebar-minimize-icon', 'images/minimize_hover.png');" 
                onmouseout= "updateImageUrl('top-titlebar-minimize-icon', 'images/minimize.png');" 
                src="images/minimize.png">
 
            
            <!-- Icon Close  -->              
            <img id="top-titlebar-close-icon" 
                onclick="_callback('clicked-close-button')" 
                onmouseover="updateImageUrl('top-titlebar-close-icon', 'images/button_close_hover.png');" 
                onmouseout= "updateImageUrl('top-titlebar-close-icon', 'images/button_close.png');" 
                src="images/button_close.png">
        </div>
        
          
        <div class="top-titlebar-divider"></div> 
        
    </div>



    <!-- Content -->      

    <div id="content">
        <div id="inner-content">
                    
            <table id="outer_table">
                <tr>
                    <!-- History arrows  --> 
                    <td>
                        <table id="arrow_table">  
                        <tr height="auto">
                            <td> 

                            </td> 
                        </tr>      
                        <tr>
                            <td> 
                            </td> 
                        </tr>            
                        <tr height="17px">
                            <td>
                                <img id="up-arrow"  height="17" width="17" 
                                    onclick="_callback( 'clicked-up-arrow')" 
                                    onmouseover="updateImageUrl('up-arrow', 'images/up-arrow_hover.png');" 
                                    onmouseout="updateImageUrl('up-arrow', 'images/up-arrow.png');" 
                                    src="images/up-arrow.png">
                            </td> 
                        </tr>            
                        <tr height="17px">
                            <td>
                                <img id="down-arrow"  height="17" width="17" 
                                    onclick="_callback( 'clicked-down-arrow')"  
                                    onmouseover="updateImageUrl('down-arrow', 'images/down-arrow_hover.png');" 
                                    onmouseout="updateImageUrl('down-arrow', 'images/down-arrow.png');" 
                                    src="images/down-arrow.png">
                            </td> 
                        </tr> 
                        <tr>
                            <td> 
                            </td> 
                        </tr>       
                         <!-- Icon Find  -->   
                        <tr height="auto"  style="height: fit-content">
                            <td>
                                <img id="bottom-titlebar-find-icon" height="17" width="17" 
                                    onclick="updateImageUrl('bottom-titlebar-find-icon', 'images/find.png');
                                             _callback('clicked-find');updateContentStyle();"
                                    onmouseover="updateImageUrl('bottom-titlebar-find-icon', 'images/find_hover.png');" 
                                    onmouseout= "updateImageUrl('bottom-titlebar-find-icon', 'images/find.png');" 
                                    src="images/find.png">
                            </td> 
                        </tr>   

                        </table>
                    </td>
                    
                    <!-- Message textarea  --> 
                    <td class="message_column">
                        <textarea style="resize: none;" class="message" id="message" onkeyup="_callback( 'message_key_up');" ></textarea>
                    </td>
                    <!-- Store button  --> 
                    <td>
                        <button id="store-button" onclick="_callback('clicked-store-button')"  disabled >Store</button>
                    </td>
                </tr>
                
                <!-- Collapsable html output  --> 
                <tr id="output_row" style="visibility:collapse">
                    <td>
                
                    </td>
                    <td class="message_column">
                        <div id="output_text">
                                                        
                            <div class="group">
                                <label for="findTextInput">  <span id="mess_text" style="color: var(--text);">message</span> &nbsp;
                                    <label class="switch">
                                        <input id="message_code_switch" type="checkbox" class="slider round" onclick="colorSwitchTexts();find_button.click()">
                                        <span class="slider round"></span> 
                                    </label>
                                    &nbsp; <span id="code_text" style="color: var(--dim-text);">code-change</span> 
                                </label>
                                <input id="findTextInput" type="text" placeholder="text"  size="25" onkeydown="clickFind()"/> 
                            </div>
                            
                            &nbsp;&nbsp;
                            
                             
                            <div class="group">
                                <label for="findFileInput"> file</label>
                                <input id="findFileInput" type="text" placeholder="file name"  size="25" onkeydown="clickFind()"/>
                            </div>
                            
                            
                            &nbsp;&nbsp;
                                                       
                            <div class="group">
                                <label for="findDateInputAfter"> since (oldest)</label>
                                <input id="findDateInputAfter" type="text" placeholder="YYYY-MM-DD"  size="12" onkeydown="clickFind()"/> 
                            </div>
                            
                            -
                            
                            <div class="group">
                                <label for="findDateInputBefore"> until (newest)</label>
                                <input id="findDateInputBefore" type="text" placeholder="YYYY-MM-DD" value="0 days" size="12" onkeydown="clickFind()"/>
                            </div>
                            
                            &nbsp;

                            <img id="about-icon-find"   height="17" width="17"  
                                onclick="_callback('help-on-find')" 
                                onmouseover="updateImageUrl('about-icon-find', 'images/questionmark_black.png');" 
                                onmouseout= "updateImageUrl('about-icon-find', 'images/questionmark_hover.png');" 
                                src="images/questionmark_hover.png">
                        </div>
                        
                    </td>
                    <td style='text-align:center' >
                            <button id="find_button"   style='vertical-align:bottom;'  onclick="_callback('clicked-find-button')" >Find</button>
                            
                    </td>
                </tr>
            </table>
            <script>
                function clickFind() {
                    if (event.keyCode == 13) {
                        find_button.click();
                    } 
                }
                function colorSwitchTexts(){
                    if ( document.getElementById("message_code_switch").checked ){
                        document.getElementById('code_text').setAttribute('style','color: var(--text)');
                        document.getElementById('mess_text').setAttribute('style','color: var(--dim-text)');
                    }else{
                        document.getElementById('code_text').setAttribute('style','color: var(--dim-text)');
                        document.getElementById('mess_text').setAttribute('style','color: var(--text)');
                    }
                }
            </script>    


        </div>
    </div>



    <!-- Bottom titlebar -->    
    
    <div id="bottom-titlebar" class="bottom-titlebar" style="background-color: rgb(122, 124, 124);">
        
        <!-- Icon Folder  -->  
        <div class="bottom-titlebar-folder-icon">
            <img id="bottom-titlebar-folder-icon"  height="17" width="17"
                onclick="updateImageUrl('bottom-titlebar-folder-icon', 'images/folder.png');
                         _callback('clicked-folder')" 
                onmouseover="updateImageUrl('bottom-titlebar-folder-icon', 'images/folder_hover.png');" 
                onmouseout="updateImageUrl('bottom-titlebar-folder-icon', 'images/folder.png');" 
                src="images/folder.png">
            </div>

        <!-- Icon Terminal  -->  
        <div class="bottom-titlebar-terminal-icon">
            <img id="bottom-titlebar-terminal-icon"  height="17" width="17"
                onclick="updateImageUrl('bottom-titlebar-terminal-icon', 'images/terminal.png');
                         _callback('clicked-terminal')" 
                onmouseover="updateImageUrl('bottom-titlebar-terminal-icon', 'images/terminal_hover.png');" 
                onmouseout="updateImageUrl('bottom-titlebar-terminal-icon', 'images/terminal.png');" 
                src="images/terminal.png">
            </div>            
 
         <!-- Text Status and pinned icon  -->     

       <div id="bottom-titlebar-div" class="bottom-titlebar-text">
    
    
            <!-- Text status  -->  
            <div id="bottom-titlebar-text" class="bottom-titlebar-status-text" 
                onclick="document.getElementById('bottom-titlebar-text').setAttribute('style','color: #ffffff');
                         _callback('clicked-status-text')"
                         
                onmouseover="document.getElementById('bottom-titlebar-text').setAttribute('style','color: #aaaaaa');" 
                onmouseout="document.getElementById('bottom-titlebar-text').setAttribute('style','color: #ffffff');" >
            </div>
            &nbsp;
            
            
             <div class="bottom-titlebar-more-icon">          
                <img id="more" style="vertical-align:middle;" height="17" width="17" 
                                    onclick="_callback( 'clicked-graph')" 
                                    onmouseover="updateImageUrl('more', 'images/more_hover.png');" 
                                    onmouseout="updateImageUrl('more', 'images/more.png');" 
                                    src="images/more.png">
            </div> 
            &nbsp;
                         
            <!-- Icon Pinned  -->                             
            <div class="top-titlebar-pinned-icon">
                <img id="top-titlebar-pinned-icon" height="17" width="17" 
                    onclick=" wasPinned = (localState.pinnedCommit !== ''); 
                              isPinned = !wasPinned;
                              _callback('clicked-pinned-icon',isPinned)"                     
                    
                             
                    onmouseover="if (localState.pinnedCommit === ''){ 
                                    updateImageUrl('top-titlebar-pinned-icon', 'images/pinned_disabled_hover.png');
                                 } else {
                                    updateImageUrl('top-titlebar-pinned-icon', 'images/pinned_enabled_hover.png');
                                 }" 
                                 
                    onmouseout="if (localState.pinnedCommit === ''){ 
                                    updateImageUrl('top-titlebar-pinned-icon', 'images/pinned_disabled.png');
                                 } else {
                                    updateImageUrl('top-titlebar-pinned-icon', 'images/pinned_enabled.png');
                                 }" 
                                 
                    src="images/pinned_disabled.png">
            </div> 
            &nbsp;
            
                
            <!-- Text status  (used in HISTORY mode, to show pinned-commit or hash) -->  
            <div id="bottom-titlebar-pinned-text" class="bottom-titlebar-status-text" 
                onclick="if (localState.pinnedCommit !== ''){
                            document.getElementById('bottom-titlebar-text').setAttribute('style','color: #ffffff');
                            _callback('clicked-pinned-hash');
                        }"
                        
                onmouseover="if (localState.pinnedCommit !== ''){ 
                                .getElementById('bottom-titlebar-pinned-text').setAttribute('style','color: #aaaaaa'); 
                            }" 
                            
                onmouseout="document.getElementById('bottom-titlebar-pinned-text').setAttribute('style','color: #ffffff');" > 
            </div>
        </div>     



            
                                               
        <!-- Icon Stash  -->                             
        <div class="bottom-titlebar-stash-icon">
            <img id="bottom-titlebar-stash-icon" height="17" width="auto" 
                onclick="updateImageUrl('bottom-titlebar-stash-icon', 'images/stash.png');
                         _callback('clicked-stash-button')" 
                onmouseover="updateImageUrl('bottom-titlebar-stash-icon', 'images/stash_hover.png');" 
                onmouseout= "updateImageUrl('bottom-titlebar-stash-icon', 'images/stash.png');" 
                src="images/stash.png">
        </div> 
        
                                             
        <!-- Icon Stash pop  -->                             
        <div class="bottom-titlebar-stash_pop-icon">
            <img id="bottom-titlebar-stash_pop-icon" height="17" width="auto" 
                onclick="updateImageUrl('bottom-titlebar-stash_pop-icon', 'images/stash_pop.png');
                         _callback('clicked-stash_pop-button')" 
                onmouseover="updateImageUrl('bottom-titlebar-stash_pop-icon', 'images/stash_pop_hover.png');" 
                onmouseout= "updateImageUrl('bottom-titlebar-stash_pop-icon', 'images/stash_pop.png');" 
                src="images/stash_pop.png">
        </div>    
            
            
            
            

        <!-- Icon Settings  -->  
        <div class="bottom-titlebar-settings-field">
            <img id="bottom-titlebar-settings-icon"  height="17" width="17"
                onclick="updateImageUrl('bottom-titlebar-settings-icon', 'images/settings.png');
                         _callback('clicked-settings')"
                onmouseover="updateImageUrl('bottom-titlebar-settings-icon', 'images/settings_hover.png');" 
                onmouseout="updateImageUrl('bottom-titlebar-settings-icon', 'images/settings.png');" 
                src="images/settings.png">
            </div>
        
        <div class="bottom-titlebar-divider"></div>
    </div>
    
    
<!--          -->    
<!-- Dialogs  -->   
<!--          -->   


    <!--  General alert dialog  --> 

    <dialog id="alertDialog" style="background-color:#C00;border:1px dotted black;">  
        <p> 
            <div id='alertTitle'></div><br>  
            <div id='alertMessage'></div>  
        </p>  
        <button id="no"
            onclick="document.getElementById('alertDialog').close();selectedBranch='';">
            OK
        </button>  
    </dialog>  
                


    <!-- Tag creation -->   
  
    <dialog id="tagNameInputDialog" style="background-color:yellow;border:1px dotted black;">  
        <b>Create branch from this commit</b><br>
            <br>
            <textarea id="tagNameTextarea" 
                rows="2" 
                cols="30" 
                placeholder="name of new tag"
                onkeyup= "_callback('newTagNameKeyUp', this);"></textarea>  
            <br>

            <br>
        
        <button  id="newTagNameEntered"
            onclick="document.getElementById('tagNameInputDialog').close();_callback('addTagButtonPressed', this.value);document.getElementById('tagNameTextarea').value='';">
            OK
        </button>           
        <button id="cancelTagNameInputDialog"
            onclick="document.getElementById('tagNameInputDialog').close();document.getElementById('tagNameTextarea').value='';">
            Cancel
        </button>  
    </dialog>             



    <!-- Branch creation -->   
  
    <dialog id="branchNameInputDialog" style="background-color:yellow;border:1px dotted black; max-height: 90%">  
        <b>Create branch from this commit</b><br>
            <br>
            <textarea id="branchNameTextarea" 
                rows="2" 
                cols="30" 
                placeholder="name of new branch"
                onkeyup= "_callback('newBranchNameKeyUp', this);"></textarea>
            <br>
            <br>

  
         <div>      
        <button  id="newBranchNameEntered"
            onclick="document.getElementById('branchNameInputDialog').close();
            _callback('addBranchButtonPressed', this.value);
            document.getElementById('branchNameTextarea').value='';
            document.getElementById('gitflow').value='none';">
            OK
        </button>           
        <button id="cancelBranchNameInputDialog"
            onclick="document.getElementById('branchNameInputDialog').close();
            document.getElementById('branchNameTextarea').value='';
            document.getElementById('gitflow').value='none';">
            Cancel
        </button> 
         
          <select id="gitflow" name="gitflow"  style="float: right;">
            <option value="none">none</option>
            <option value="feature">feature/</option>
            <option value="release">release/</option>
            <option value="hotfix">hotfix/</option>
          </select>
          <label for="gitflow" style="float: right;">Prefix:</label>
          </div>
    </dialog>      



    <!-- Git not installed alert -->   
  
    <dialog id="gitNotInstalledAlert" style="background-color:#C00;border:1px dotted black;">  
        <b>ERROR -- Cannot find "git" !</b><br>
            Please make sure "git" is installed. <br>
            See manual for help (<img style='vertical-align:middle;' src="images/questionmark_black.png"  height="17" width="17">  in top-left corner of the main window)<br>
            <br>
        
        <button 
            onclick="document.getElementById('gitNotInstalledAlert').close();">
            OK
        </button>   
        
    </dialog>      



    <!-- Detached head dialog -->   
  
    <dialog id="detachedHeadDialog" style="background-color:#C00;border:1px dotted black;">  
        <b>WARNING -- detached HEAD !</b><br>
            You've created work in an old revision. <br>
            1) Keep work : a temporary branch will be created<br>
            2) Delete : drop work done on old revision<br>
            <br>
        
        <button id="tempBranchDetachedDialog" value="Temp_Branch"
            onclick="document.getElementById('detachedHeadDialog').close();document.getElementById('branchNameInputDialog').showModal();"> <!-- Call html-dialog for branch selection -->
            1) Temp Branch
        </button>   
        <button id="deleteDetachedDialog" value="Delete"
            onclick="document.getElementById('detachedHeadDialog').close();_callback('detachedHeadDialog', this.value);">
            2) Delete
        </button>     
        <button id="cancelDetachedDialog" value="Cancel"
            onclick="document.getElementById('detachedHeadDialog').close();_callback('detachedHeadDialog', this.value);">
            Cancel
        </button>  
    </dialog>  


    <!-- Dropped file is not a repo -->   
  
    <dialog id="doYouWantToInitializeRepoDialog" style="background-color:yellow;border:1px dotted black;">  
        <b>WARNING -- the dropped folder is not a repository.</b><br>
            Do you want to initialize this folder as a git repository ? <br>
            <br>
        
        <button id="initializeRepoDialogOK" 
            onclick="document.getElementById('doYouWantToInitializeRepoDialog').close();_callback('initializeRepoOK');">
            Initialize
        </button>   
        <button id="initializeRepoDialogCancel" 
            onclick="document.getElementById('doYouWantToInitializeRepoDialog').close();localState.droppedRepoFolder=''; "> <!-- Forget dropped folder -->  
            Cancel
        </button>     

    </dialog>  


</body>

    
    <!-- Drop folder initiate script-->    
    <script>
    
        //Same as $(document).ready();
        function ready(fn) {
            if (document.readyState != 'loading'){
                fn();
            } else {
                document.addEventListener('DOMContentLoaded', fn);
            }
        }
    
        //When the page has loaded, run this code
        ready( function(){
            // prevent default behavior from changing page on dropped file
            window.ondragover = function(e) { e.preventDefault(); return false };
            
            // NOTE: ondrop events WILL NOT WORK if you do not "preventDefault" in the ondragover event!!
            window.ondrop = function(e) { e.preventDefault(); return false };
        
            const holder = document.getElementById('content');
            holder.ondragover = function () { this.className = 'hover'; return false; };
            holder.ondragleave = function () { this.className = ''; return false; };
            
            holder.ondrop = function(e) {  _callback('file-dropped', e); return false }; // See app.js
        
        });
    </script>
</html>
