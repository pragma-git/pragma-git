<!DOCTYPE html> 
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="../color_styles.css" />   
        
        
        <style>           
            :root {
              --windowScaling: 1;
              --vw: 100vw;
              --vh: 100vh;
            }     
            
            iframe {
                width:  var(--vw);
                height: var(--vh);
                border : 0px;
                transform: scale( var(--windowScaling) );
                transform-origin: top left;
                position: absolute;
            }

        </style>
        
        
        <script>
            let root = document.documentElement;
            
            
            root.style.setProperty('--windowScaling', global.state.zoom);
            root.style.setProperty('--vw', Math.round( 100 * (1 / global.state.zoom ) ) + 'vw') ;
            root.style.setProperty('--vh', Math.round( 100 * (1 / global.state.zoom ) ) + 'vh') ;
            
            
            //document.getElementById('iframe').
        </script>      
        
        
    </head>


    <body class="light" style = "margin: 0px; overflow:hidden">
        
            
        <script>
            if (global.localState.dark){
                document.body.classList.remove('light');
                document.body.classList.add('dark');
            }
        </script>
        
        
  
        
        
        
        <iframe id="iframe" src="pragma-merge_iframe.html"></iframe>
            
            
            
        <script>
            window.addEventListener('DOMContentLoaded', (event) => {
                    let root = document.documentElement;
                    
                    
                    root.style.setProperty('--windowScaling', global.state.zoom);
                    root.style.setProperty('--vw', Math.round( 100 * (1 / global.state.zoom ) ) + 'vw') ;
                    root.style.setProperty('--vh', Math.round( 100 * (1 / global.state.zoom ) ) + 'vh') ;
            
                }
            );  
            
            
            window.addEventListener("keydown", event => {
                
                
                // Work in iframe
                let iframe = document.getElementById('iframe').contentWindow;
                
                console.log(event )
                if ( (event.ctrlKey || event.metaKey) && event.keyCode === 83 ){  // Ctrl, Cmd S
                    finish('save')
                }                
                if ( (event.ctrlKey || event.metaKey) && event.keyCode === 70 ){  // Ctrl, Cmd F
                    iframe.pragmaMergeSearchInEditorId = 'CodeMirror-merge-editor'; 
                    iframe.positionSearchBoxPragmaMerge();
                }                      
                if ( (event.ctrlKey || event.metaKey) && event.keyCode === 71 ){  // Ctrl, Cmd G
                    iframe.contentWindow.nextClicked(); 
                }                   
                if (event.keyCode === 27) {  // ESC
                    iframe.contentWindow.closeSearchDialog();
                }            
            });
            
            
            
        </script>  
        
        

            
    
    </body>    
</html>
