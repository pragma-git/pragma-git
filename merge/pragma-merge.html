<!DOCTYPE html> 
<html>
  <head>

    <meta name="viewport" content="user-scalable=1.0,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 

    <title id='title'>Merge/Diff</title>
    
    
    <link rel="stylesheet" href="node_modules/codemirror/lib/codemirror.css">
    <link rel="stylesheet" href="node_modules/codemirror/addon/merge/merge.css">

  
    <script src="node_modules/codemirror/lib/codemirror.js"></script>
    
    <script src="node_modules/codemirror/mode/xml/xml.js"></script>
    <script src="node_modules/codemirror/mode/css/css.js"></script>
    <script src="node_modules/codemirror/mode/javascript/javascript.js"></script>
    <script src="node_modules/codemirror/mode/htmlmixed/htmlmixed.js"></script>
    

    <script src="node_modules/diff-match-patch/index.js"></script>

    <script src="node_modules/codemirror/addon/merge/merge.js"></script>
    
    <script src="pragma-merge.js"></script>
    

    <link rel="stylesheet" type="text/css" href="../color_styles.css" />   
    
     <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background: var(--body-background);
            color: var( --body-text);
            overflow: hidden;
        }  


        .outer-content {
            width: 100%;
            height: auto;
            margin-right: 10px;
            border:none;
        }


     
     </style>
        
    
    
    <style>   
        .CodeMirror { 
            line-height: 1.4; 
        }
        
        #view{
            padding-right: 18px;
            padding-left: 12px;
        }

        span.clicky {
          cursor: pointer;
          color: black;
          padding: 0 3px;
          border-style: solid;
          border-width: 1px;
          border-radius: 2px;
          border-color: var( --body-text);
          float: left;
          display: block;
          margin-right: 2px;
        }
        
                
        .enabled{
            background: lightgreen;
        }
        .disabled{
            background: white;
        }
        
        
        span.checkbox {   
          float: left;
          display: block;
        }
        
        #up, #down, #align, #hide-unchanged{
          color: var( --body-text);
          border-color: var( --body-text);
        }
        
        .CodeMirror-merge, .CodeMirror-merge .CodeMirror {
            height: calc(100vh / 0.5 - 86px ); 
        }
        
        .CodeMirror-merge-editor{
            border-style: solid;
            border-width: 1px;
            border-color: navy;
            border:none;
        }
        
        .CodeMirror-merge-scrolllock{
            visibility: collapse;  /* Hide */
        }
        
        .CodeMirror
        {
            background: var(--merge-body-background);
            color: var(--merge-color);
            border:none;
        }
        
        .CodeMirror-merge-gap, .CodeMirror-gutter,
        #editor2, #right2, 
        #editor3, #left3, #right3,
        .CodeMirror-linenumber  
        {
            background: var(--body-background);
            color: var(--body-text) !important;
            border:none;
        }
        
        .CodeMirror-merge-copy{
            color: var(--merge-arrow);
        }
        
        .CodeMirror-merge-r-chunk
        {
            background: antiquewhite !important;
            fill: antiquewhite !important;
            stroke: antiquewhite !important;
        }      
        
        
        .CodeMirror-merge-r-connect
        {
            background: grey;
            fill: grey;
            stroke: grey;
        }          


  </style>
  


</head>


  <body class='light'>
    <!-- Dark mode on/off --> 
    <script>
        if (global.localState.dark){
            document.body.classList.remove('light');
            document.body.classList.add('dark');
        }
        window.document.body.style.zoom = global.state.zoom;
    </script>


    <div class="outer-content">
        <table id="Headers3" style="width:100%; visibility: collapse;">
            <tr>
                <td id="left3" style="width:33%; text-align: center;">left</td>
                <td id="editor3" style="width:33%; text-align: center;">center</td>
                <td id="right3" style="width:33%; text-align: center;">right</td>
            </tr>
        </table>
        
        
        <table id="Headers2" style="width:100%; visibility: collapse;">
            <tr>
                <td id="editor2" style="width:50%; text-align: center;">left</td>
                <td id="right2" style="width:50%; text-align: center;">right</td>
            </tr>
        </table>

        <div id="view"></div>
    </div>       
    
    
    <p style="margin-right: 10 px;"> 
        <div>
            <span id='two-way'    class=clicky onclick="panes = 2; initUI()">two-way</span>
            <span id='three-way'  class=clicky onclick="panes = 3; initUI()">three-way</span>

    
            <span class=checkbox>
                <input type="checkbox" id='align' class=clicky 
                    onclick="connect = connect ? null : 'align'; 
                        initUI();
                        obj = document.getElementById('theme-select');
                        themeSelected( obj.options[obj.selectedIndex].text);"
                > 
                align
                    
                <input type="checkbox" id='hide-unchanged'  class=clicky  
                    onclick="collapse = !collapse; 
                        initUI();
                        obj = document.getElementById('theme-select');
                        themeSelected( obj.options[obj.selectedIndex].text);"
                > 
                hide unchanged

    
                <select id="theme-select" style="position: relative; left: 20px" 
                    onChange="initUI();themeSelected( this.options[this.selectedIndex].text);">
                    <option>default</option>
                    <option disabled>──────────</option>
                    <option chunk-color="default">zenburn</option>
                    <option chunk-color="antiquewhite">3024-day</option>
                    <option chunk-color="default">3024-night</option>
                    <option chunk-color="default">abcdef</option>
                    <option chunk-color="#888">ambiance</option>
                    <option chunk-color="default">ayu-dark</option>
                    <option chunk-color="default">ayu-mirage</option>
                    <option chunk-color="default">base16-dark</option>
                    <option chunk-color="antiquewhite">base16-light</option>
                    <option chunk-color="default">bespin</option>
                    <option chunk-color="default">blackboard</option>
                    <option chunk-color="default">cobalt</option>
                    <option chunk-color="default">colorforth</option>
                    <option chunk-color="default">darcula</option>
                    <option chunk-color="default">dracula</option>
                    <option chunk-color="default">duotone-dark</option>
                    <option chunk-color="antiquewhite">duotone-light</option>
                    <option chunk-color="antiquewhite">eclipse</option>
                    <option chunk-color="antiquewhite">elegant</option>
                    <option chunk-color="default">erlang-dark</option>
                    <option chunk-color="default">gruvbox-dark</option>
                    <option chunk-color="default">hopscotch</option>
                    <option chunk-color="default">icecoder</option>
                    <option chunk-color="antiquewhite">idea</option>
                    <option chunk-color="dimgray">isotope</option>
                    <option chunk-color="default">liquibyte</option>
                    <option chunk-color="default">lucario</option>
                    <option chunk-color="#333">material-darker</option>
                    <option chunk-color="#222">material-ocean</option>
                    <option chunk-color="#333">material-palenight</option>
                    <option chunk-color="#333">material</option>
                    <option chunk-color="default">mbo</option>
                    <option chunk-color="antiquewhite">mdn-like</option>
                    <option chunk-color="default">midnight</option>
                    <option chunk-color="default">monokai</option>
                    <option chunk-color="dimgray">moxer</option>
                    <option chunk-color="antiquewhite">neat</option>
                    <option chunk-color="antiquewhite">neo</option>
                    <option chunk-color="default">night</option>
                    <option chunk-color="#888">nord</option>
                    <option chunk-color="darkslategray">oceanic-next</option>
                    <option chunk-color="default">panda-syntax</option>
                    <option chunk-color="default">paraiso-dark</option>
                    <option chunk-color="bisque">paraiso-light</option>
                    <option chunk-color="default">pastel-on-dark</option>
                    <option chunk-color="default">railscasts</option>
                    <option chunk-color="default">rubyblue</option>
                    <option chunk-color="antiquewhite">seti</option>
                    <option chunk-color="default">shadowfox</option>
                    <option chunk-color="antiquewhite">solarized</option>
                    <option chunk-color="antiquewhite">ssms</option>
                    <option chunk-color="default">the-matrix</option>
                    <option chunk-color="default">tomorrow-night-bright</option>
                    <option chunk-color="default">tomorrow-night-eighties</option>
                    <option chunk-color="antiquewhite">ttcn</option>
                    <option chunk-color="default">twilight</option>
                    <option chunk-color="default">vibrant-ink</option>
                    <option chunk-color="default">xq-dark</option>
                    <option chunk-color="antiquewhite">xq-light</option>
                    <option chunk-color="#666">yeti</option>
                    <option chunk-color="default">yonce</option>
                </select>            
                
            </span>
            
        </div>
        
        
        <div id='jump' style="position: absolute; left: 50%; bottom: 20px"> 
             <span id='down' class=clicky onclick="dv.edit.execCommand('goNextDiff');"> &#x2B07;</span> 
             <span id='up'   class=clicky onclick="dv.edit.execCommand('goPrevDiff');"> &#x2B06;</span> 
        </div>
        
        
        <button id="close" 
            onclick="finish('close');" 
            style="float: none;margin-right: 10px; visibility: collapse">
            Close
        </button>
        
               
        <button id="save" 
            onclick="finish('save');" 
            style="float: right;margin-right: 10px;">
            Save
        </button>
        
        
        <button id="cancel" 
            onclick="finish('cancel')" 
            style="float: right;margin-right: 10px;">
            Cancel
        </button>
        
    </p>


 
    <!--  Onload, call javascript file  --> 
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            console.log('merge.html :DOM fully loaded and parsed');
            injectIntoJs(document);
            }
        );    
            
        window.addEventListener('unload', (event) => {
            console.log('merge.html :DOM fully unloaded -- maybe window closed ');
            finish('unloadWindow');
            }
        );     
        
        window.addEventListener('resize',  update );
        function update(){
            initUI();
            themeSelected( global.state.pragmaMerge.codeTheme);
        }

        window.addEventListener("keydown", event => {
            if ( (event.ctrlKey || event.metaKey) && event.keyCode === 83 ){
                finish('save')
            }
        });
          
          
    </script>  
    
    <!--  Add find  -->    
    <script src="../node_modules/findinnw/dist/find-in-nw.js"></script>
    <script src="../extend_find-in-nw.js"></script>
    <script>
        findInNw.initialize();
        extendFindInNw(); // Make find-in-nw fit my purpose for graph and note and pragma-merge
        
        var pragmaMergeSearchInEditorId;  // This shows the active editor window to do the search in
    </script> 


</body>    
</html>
